generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model User {
  id           Int      @id @default(autoincrement())
  firstName    String?  @db.VarChar(255)
  lastName     String?  @db.VarChar(255)
  email        String?  @unique @db.VarChar(255)
  password     String?  @db.VarChar(255)
  refreshToken String?  @db.VarChar(255)
  createdAt    DateTime @default(now())
  updatedAt    DateTime @default(now()) @updatedAt
}

// Scheme Name and ISIN code relation
model Scheme {
  id        Int      @id @default(autoincrement())
  code      Int      @unique
  createdAt DateTime @default(now())
  updatedAt DateTime @default(now()) @updatedAt
  isin      ISIN[]
}

// ISIN code and relation with return_type, plan_type, NAV, scheme_code
model ISIN {
  id             Int         @id @default(autoincrement())
  isin           String      @unique
  name           String
  plan_type      Int
  return_type    Int
  scheme_id      Int
  createdAt      DateTime    @default(now())
  updatedAt      DateTime    @default(now()) @updatedAt
  scheme_code    Scheme      @relation(fields: [scheme_id], references: [code])
  plan_type_id   Plan_type   @relation(fields: [plan_type], references: [id])
  return_type_id Return_type @relation(fields: [return_type], references: [id])
  nav            NAV[]
}

// All NAV for all ISINs
model NAV {
  id               Int      @id @default(autoincrement())
  isin             String
  nav              Float
  date             DateTime
  repurchase_price Int
  sale_price       Int
  createdAt        DateTime @default(now())
  updatedAt        DateTime @default(now()) @updatedAt
  isin_id          ISIN     @relation(fields: [isin], references: [isin])
}

// Return type -> Growth, DividendPayout, DividendReinvestment
model Return_type {
  id        Int      @id @default(autoincrement())
  name      String   @unique @db.VarChar(255)
  createdAt DateTime @default(now())
  updatedAt DateTime @default(now()) @updatedAt
  isin_id   ISIN[]
}

// Plan type -> Direct, Regular
model Plan_type {
  id        Int      @id @default(autoincrement())
  name      String   @unique @db.VarChar(255)
  createdAt DateTime @default(now())
  updatedAt DateTime @default(now()) @updatedAt
  isin_id   ISIN[]
}
